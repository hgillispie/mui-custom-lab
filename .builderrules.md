# .builderrules - Material UI Customization with Design Tokens

## 🔴 CRITICAL: MUI Customization Strategy

### We're Using Material UI WITH Proper Customization
- **Import and use Material UI components directly**
- **Customize through MUI's theme system**
- **Apply our design tokens via styleOverrides**
- **Maintain all MUI functionality**
- **Progressive enhancement approach**

## Theme Configuration Location

### Primary Theme File
`client/theme/mui-theme.ts` - This is where ALL global customizations live:
- Typography (Figtree font)
- Color palette (from design tokens)
- Component styleOverrides
- Shape and spacing configurations

## Customization Priority Order

### 1. Global Theme Overrides (PREFERRED)
```typescript
// In mui-theme.ts - affects ALL instances
components: {
  MuiButton: {
    styleOverrides: {
      root: {
        textTransform: 'none',
        borderRadius: 'var(--radius-md)',
        fontFamily: 'Figtree',
      },
    },
  },
}
```

### 2. styled() Components (For Reusable Variants)
```typescript
// When you need a reusable variant
const GradientButton = styled(Button)(({ theme }) => ({
  background: 'linear-gradient(45deg, var(--color-primary-500) 30%, var(--color-primary-400) 90%)',
}));
```

### 3. Component Wrappers (For Business Logic)
```typescript
// When adding custom props or logic
export const Button = (props) => {
  const { loading, ...muiProps } = props;
  return (
    <MuiButton
      {...muiProps}
      disabled={loading || muiProps.disabled}
      startIcon={loading ? <CircularProgress size={16} /> : muiProps.startIcon}
    />
  );
};
```

### 4. sx Prop (For One-offs ONLY)
```typescript
// Only for specific, one-time customizations
<Button sx={{ borderRadius: 'var(--radius-full)' }}>
  Special Round Button
</Button>
```

## Design Token Usage

### ALWAYS Use CSS Variables
```typescript
// ✅ CORRECT - Uses design tokens
borderRadius: 'var(--radius-md)'
padding: 'var(--spacing-2) var(--spacing-4)'
backgroundColor: 'var(--color-primary-500)'

// ❌ WRONG - Hardcoded values
borderRadius: '8px'
padding: '8px 16px'
backgroundColor: '#8b5cf6'
```

### Available Token Categories
- **Colors**: `var(--color-primary-500)`, `var(--color-gray-200)`
- **Spacing**: `var(--spacing-2)`, `var(--spacing-4)`
- **Radius**: `var(--radius-sm)`, `var(--radius-md)`, `var(--radius-lg)`
- **Shadows**: `var(--shadow-sm)`, `var(--shadow-md)`, `var(--shadow-lg)`
- **Typography**: Already configured in theme

## Component Customization Checklist

### Before Customizing Any Component:
- [ ] Check if theme override exists in `mui-theme.ts`
- [ ] Identify which design tokens to use
- [ ] Determine customization method (theme vs styled vs sx)
- [ ] Test all component states (hover, focus, disabled)
- [ ] Verify Figtree font is applied
- [ ] Ensure accessibility is maintained

## Example: Complete Button Customization

### Step 1: Theme Override (mui-theme.ts)
```typescript
MuiButton: {
  defaultProps: {
    disableElevation: true, // Remove default shadow
  },
  styleOverrides: {
    root: {
      textTransform: 'none',
      fontWeight: 500,
      borderRadius: 'var(--radius-md)',
      transition: 'all 200ms ease',
      padding: 'var(--spacing-2) var(--spacing-4)',
    },
    containedPrimary: {
      backgroundColor: 'var(--color-primary-500)',
      color: 'white',
      '&:hover': {
        backgroundColor: 'var(--color-primary-600)',
        transform: 'translateY(-1px)',
        boxShadow: 'var(--shadow-md)',
      },
    },
    outlinedPrimary: {
      borderColor: 'var(--color-primary-500)',
      borderWidth: '2px',
      '&:hover': {
        borderWidth: '2px',
        borderColor: 'var(--color-primary-600)',
        backgroundColor: 'rgba(139, 92, 246, 0.04)',
      },
    },
    sizeLarge: {
      padding: 'var(--spacing-3) var(--spacing-6)',
      fontSize: 'var(--font-size-lg)',
    },
    sizeSmall: {
      padding: 'var(--spacing-1) var(--spacing-3)',
      fontSize: 'var(--font-size-sm)',
    },
  },
}
```

### Step 2: Usage in Component
```tsx
import Button from '@mui/material/Button';
import { Save as SaveIcon } from '@mui/icons-material';

// It automatically uses our customization!
<Button variant="contained" color="primary" startIcon={<SaveIcon />}>
  Save Changes
</Button>
```

## Progressive Component Plan

### Phase 1: Core Components (Do These First)
1. **Button** ✅
   - All variants (contained, outlined, text)
   - All sizes (small, medium, large)
   - Icon support

2. **TextField**
   - Border colors from tokens
   - Focus states
   - Error states

3. **Card**
   - Border radius
   - Shadows
   - Hover effects

### Phase 2: Form Components
- Select
- Checkbox
- Radio
- Switch
- Autocomplete

### Phase 3: Navigation
- AppBar
- Drawer
- Tabs
- Breadcrumbs
- Menu

### Phase 4: Feedback
- Alert
- Dialog
- Snackbar
- Progress
- Skeleton

## Common Patterns

### Pattern: Hover Effects
```typescript
'&:hover': {
  backgroundColor: 'var(--color-primary-600)',
  transform: 'translateY(-1px)',
  boxShadow: 'var(--shadow-md)',
  transition: 'all 200ms ease',
}
```

### Pattern: Focus States
```typescript
'&:focus-visible': {
  outline: '2px solid var(--color-primary-500)',
  outlineOffset: '2px',
}
```

### Pattern: Disabled States
```typescript
'&.Mui-disabled': {
  opacity: 0.6,
  cursor: 'not-allowed',
}
```

## Testing Requirements

### Every Customized Component Must:
1. **Render** with all variants
2. **Display** Figtree font
3. **Use** design tokens (no hardcoded values)
4. **Support** all original MUI props
5. **Maintain** accessibility features
6. **Handle** all interaction states
7. **Work** in light/dark modes (if applicable)

## File Organization

```
client/
├── theme/
│   └── mui-theme.ts          # All global MUI customizations
├── components/
│   ├── providers/
│   │   └── MuiThemeProvider.tsx  # Theme provider wrapper
│   └── ui/                   # Optional wrapped components
│       ├── Button.tsx
│       ├── TextField.tsx
│       └── Card.tsx
├── styles/
│   ├── tokens.css           # Design token definitions
│   └── global.css           # Global styles
└── App.tsx                  # Wrapped with MuiThemeProvider
```

## DO's and DON'Ts

### DO's
✅ Use theme overrides for consistency
✅ Reference design tokens via CSS variables
✅ Test all component states
✅ Maintain MUI's built-in features
✅ Document customizations
✅ Use TypeScript for type safety

### DON'Ts
❌ Don't hardcode color values
❌ Don't use !important (except as last resort)
❌ Don't break MUI's accessibility
❌ Don't customize in multiple places
❌ Don't forget hover/focus states
❌ Don't override core MUI behavior

## Debugging Tips

### Component Not Using Custom Styles?
1. Check theme is applied via MuiThemeProvider
2. Verify styleOverrides syntax
3. Check specificity (MUI uses nested classes)
4. Inspect element for applied styles
5. Clear cache and rebuild

### Font Not Applying?
1. Verify Figtree is loaded in index.html
2. Check typography.fontFamily in theme
3. Inspect computed styles in DevTools
4. Look for conflicting CSS

## Quick Reference

### Import Material UI Component
```typescript
import { Button, TextField, Card } from '@mui/material';
```

### Use with Customization
```tsx
// Automatically uses theme customization
<Button variant="contained" color="primary">
  Styled Button
</Button>
```

### One-off Customization
```tsx
<Button
  sx={{
    borderRadius: 'var(--radius-full)',
    px: 'var(--spacing-6)',
  }}
>
  Special Button
</Button>
```

## Success Criteria

Component customization is complete when:
- ✅ Matches design system visually
- ✅ Uses Figtree font
- ✅ All design tokens applied
- ✅ Original functionality preserved
- ✅ Accessible
- ✅ Performant
- ✅ Documented